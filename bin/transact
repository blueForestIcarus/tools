#!/bin/bash

F="$1"
KEY="$2"
VALUE="$3"

TMP="`mktemp`"
rg -v -F "$KEY" "$F" > "$TMP"
if [ "$VALUE" != "--" ];then
    echo "$VALUE" >> $TMP
fi
#TODO handle multi-line comments/strings

diff "$F" "$TMP"
mv -f "$F" "$F.orig"
mv "$TMP" "$F"
rm "$TMP"

